---
title: "Analyzing Factors Associated with Area Burned by Wildfires in the United States"
author: "Info Innovators: Kevin Mao, Arnav Meduri, Ben Trokenheim, Ricardo Urena"
date: "March 20, 2025"
format: pdf
execute: 
  warning: false
  message: false
  echo: false
editor: visual
---

## Introduction and Data

#### Background and Data Description

Wildfires are destructive natural disasters that occur regularly across the United States. According to the EPA, the U.S. has averaged approximately 70,000 wildfires per year since 1983[^1]. Although fire is a natural part of many ecosystems, wildfires have important economic and environmental consequences (e.g., property loss, greenhouse gas emissions, and ecosystem degradation). After learning about recent wildfire events in California and western North Carolina, we became interested in better understanding the factors that contribute to variation in the area burned by wildfires. With wildfires affecting many parts of the country, identifying the factors associated with the extent of area burned can help inform decisions by wildfire management agencies. In light of this, we focused on two primary research questions: (a) What factors known before a wildfire has occurred are most strongly associated with the area burned? and (b) What overall factors (including those available after a wildfire) help explain variability in burned area? To answer these research questions, we conducted exploratory data analysis and fitted multiple linear regression models to examine associations between wildfire characteristics and area burned.

[^1]: United States Environmental Protection Agency, "Climate Change Indicators: Wildfires," 2023, https://www.epa.gov/climate-indicators/climate-change-indicators-wildfires.

The dataset used in this analysis is an integrated dataset consisting of over 55,000 wildfire records from the United States between 1992 and 2015, compiled from the Fire Program Analysis system. In addition to wildfire-specific attributes recorded in this database, the dataset was supplemented with additional information from the Forest Service Research Data Archive, NOAA Integrated Surface Hourly Database, vegetation and land cover data from Meiyappan and Jain’s global land-use dataset, and geographic proximity data from SimpleMap’s World Cities Database. As part of our analysis, we used a subset of these variables, including fire size (measured in acres) as the response variable; cause of fire (categorized as missing/undefined, arson, debris burning, miscellaneous, campfire, fireworks, children, lightning, equipment use, smoking, railroad, structure, or powerline); temperature (°C), wind speed (meters per second), relative humidity (%), and precipitation (millimeters) recorded 30 days prior to the fire; vegetation classification based on land cover (with categories Open Shrubland, Polar Desert/Rock/Ice, Secondary Tropical Evergreen Broadleaf Forest, Temperate Evergreen Needleleaf Forest, C3 Grassland/Steppe, Desert, and Water/Rivers); and remoteness (a unitless value between 0 and 1 representing the scaled distance from the nearest urban center).

#### Hypotheses

We hypothesize that (1) wildfire event characteristics, environmental conditions prior to discovery, and geographic factors are associated with the area burned, since hotter, drier, and windier conditions are likely to be positively associated with burned area, more flammable vegetation and greater remoteness are also likely to be positively associated, and certain fire characteristics may influence fire size, and that (2) variables available after a wildfire occurs help explain additional variability in burned area, since information available after discovery (e.g., underlying cause of the fire and environmental or geographic conditions observed during containment) may be related to how the fire spread and how difficult it was to control.

## Exploratory Data Analysis

### Data Cleaning

Before conducting our analysis, we applied many data cleaning steps to prepare our dataset for modeling and interpretation. One of the major decisions we made as part of our data cleaning process was to filter our response variable, acres burned, since the majority of observations in our dataset (over 13,000) recorded fires that burned one acre or less of land (i.e., small-scale wildfires). In our analysis, we decided to focus only on the interquartile range (middle 50%) of wildfires by acres burned because a) the goal of our analysis was to focus on wildfires that can reasonably be addressed during early containment efforts (rather than fires that had already expanded beyond an early intervention phase) and b) to narrow our practical range for analysis (i.e., wildfires representative of "typical" wildfire events).

Our data cleaning process also involved transforming many of our variables of interest to make downstream analysis and interpretation more manageable. For example, we observed that most precipitation-related variables in our dataset were heavily left-skewed (i.e., the majority of observations corresponded to wildfire events with no recorded precipitation during a given time period before discovery), so we transformed all precipitation variables into binary indicators (0 = no precipitation, 1 = precipitation greater than 0). Additionally, we "collapsed" many categorical variables with a large number of levels in our dataset, mainly to help with model interpretability and to reduce model complexity. Specifically, we grouped states into four broader regions based on U.S. Census classifications (Northeast, Midwest, South, and West), vegetation types into broader environmental categories (e.g., Forest, Shrubland, Grassland), and cause descriptions into broader cause categories (e.g., Natural, Recreational, Infrastructure).

Following standard data cleaning practices, we dropped all observations with missing values for any variables of interest in our dataset. Finally, we converted all categorical variables of interest (e.g., vegetation type, fire cause, geographic region) into factor variables to support appropriate handling during modeling and analysis.

```{r}
#| label: load-packages-and-data
#| echo: false
#| warning: false

library(knitr)
library(lubridate)
library(stringr)
library(patchwork)
library(GGally)
library(tidyverse)
library(tidymodels)
library(rms)

wildfire <- read_csv("data/FW_Veg_Rem_Combined.csv")
```

```{r}
#| label: clean-data

wildfire_clean <- wildfire |>
  select(-(1:2)) |> 
  mutate(
    Prec_pre_30 = if_else(Prec_pre_30 == -1, NA_real_, if_else(Prec_pre_30 == 0, 0, 1)),
    Prec_pre_15 = if_else(Prec_pre_15 == -1, NA_real_, if_else(Prec_pre_15 == 0, 0, 1)),
    Prec_pre_7  = if_else(Prec_pre_7  == -1, NA_real_, if_else(Prec_pre_7  == 0, 0, 1)),
    Prec_cont   = if_else(Prec_cont   == -1, NA_real_, if_else(Prec_cont   == 0, 0, 1)),
    putout_time_num = parse_number(putout_time),
    Vegetation = factor(Vegetation),
    stat_cause_descr = factor(stat_cause_descr),
    state = factor(state),
    region = case_when(
      state %in% c("CT", "ME", "MA", "NH", "RI", "VT", "NJ", "NY", "PA") ~ "Northeast",
      state %in% c("IL", "IN", "MI", "OH", "WI", "IA", "KS", "MN", "MO", 
                   "NE", "ND", "SD") ~ "Midwest",
      state %in% c("DE", "FL", "GA", "MD", "NC", "SC", "VA", "DC", "WV", 
                   "AL", "KY", "MS", "TN", "AR", "LA", "OK", "TX") ~ "South",
      state %in% c("AZ", "CO", "ID", "MT", "NV", "NM", "UT", "WY", "AK", 
                   "CA", "HI", "OR", "WA") ~ "West"
    ) |> factor(),
    cause_category = case_when(
      stat_cause_descr == "Lightning" ~ "Natural",
      stat_cause_descr %in% c("Campfire", "Children", "Fireworks", "Smoking") ~ "Recreational",
      stat_cause_descr == "Debris Burning" ~ "Debris Burning",
      stat_cause_descr == "Arson" ~ "Arson",
      stat_cause_descr %in% c("Equipment Use", "Powerline", "Railroad", "Structure") ~ "Infrastructure",
      stat_cause_descr %in% c("Miscellaneous", "Missing/Undefined") ~ "Other/Unknown",
      TRUE ~ "Other"
    ) |> factor(),
    Vegetation_group = case_when(
      Vegetation %in% c(0, 9) ~ "Tundra/Barren",         
      Vegetation %in% c(4, 5, 6, 7) ~ "Grassland",        
      Vegetation %in% c(10, 11, 12) ~ "Shrubland",        
      Vegetation %in% c(13, 14, 15, 16) ~ "Forest",       
      Vegetation %in% c(1, 2, 3, 8) ~ "Wetland/Other",    
      TRUE ~ "Other"
    ) |> factor()
  ) |>
  filter(!is.na(region)) |> 
  drop_na(
    fire_mag, stat_cause_descr, Vegetation, remoteness, fire_size, putout_time,
    Prec_pre_15, Prec_pre_30, Prec_pre_7, Prec_cont,
    Hum_pre_15, Hum_pre_30, Hum_pre_7, Hum_cont,
    Temp_pre_15, Temp_pre_30, Temp_pre_7, Temp_cont,
    Wind_pre_15, Wind_pre_30, Wind_pre_7, Wind_cont
  ) |>
  filter(
    fire_size >= quantile(fire_size, 0.25, na.rm = TRUE),
    fire_size <= quantile(fire_size, 0.75, na.rm = TRUE)
  ) |>
  mutate(
    mid50_hi = if_else(fire_size > median(fire_size, na.rm = TRUE), 1, 0),
    mid50_hi = factor(mid50_hi, levels = c(0, 1))
  )

write_csv(wildfire_clean, "data/wildfire_clean.csv")
```

#### Univariate EDA

As part of our analysis, we first conducted univariate EDA to better understand the distribution of variables in our dataset and to identify patterns (e.g., skewness, outliers) and potential data quality issues that could affect subsequent modeling. As mentioned previously, we focused on the middle 50% of wildfires by acres burned because these represent moderate-sized fires that are more likely to be responsive to early containment efforts.

Based on the histogram of burned area (top panel), we can see that the distribution of moderate-sized wildfires is right-skewed and unimodal. Additionally, we can see that there is a clear peak at 3,978 observations corresponding to wildfires that burned less than 2 acres of land. According to the summary statistics, the mean burned area within this subset is 11.84 acres, and the typical (median) wildfire size is 5 acres. The middle 50% of burned area values in our dataset falls between 2.5 acres (first quartile) and 14.7 acres (third quartile), and the minimum and maximum values are 1.5 and 80 acres, respectively; the standard deviation is 15.62 acres, which tells us there is substantial variability in fire size within this range. Additionally, based on the boxplot visualization (bottom panel), we can see that there are many wildfires with burned areas above 30 acres that extend beyond the typical range of values. These wildfires are moderate outliers within this subset.

```{r}
#| label: fire-size-dist
#| echo: false
#| warning: false
#| fig-width: 8
#| fig-height: 6

p1 <- ggplot(wildfire_clean, aes(x = fire_size)) +
  geom_histogram(fill = "cadetblue4", color = "white", alpha = 0.8, binwidth = 2) +
  labs(
    title = "Histogram",
    x = "Burned Area (acres)",
    y = "Frequency"
  ) +
  theme_minimal() +
  theme(
    plot.title = element_text(size = 10, hjust = 0),
    axis.title.x = element_text(size = 9),
    axis.title.y = element_text(size = 9)
  )

p2 <- ggplot(wildfire_clean, aes(x = fire_size, y = "")) +
  geom_boxplot(width = 0.2, color = "cadetblue4") +
  labs(
    title = "Boxplot",
    x = "Burned Area (acres)",
    y = NULL
  ) +
  theme_minimal() +
  theme(
    plot.title = element_text(size = 10, hjust = 0),
    axis.title.x = element_text(size = 9),
    axis.text.y = element_blank(),
    axis.ticks.y = element_blank()
  )

(p1 / p2) +
  plot_layout(heights = c(2, 1)) +   
  plot_annotation(
    title = "Distribution of Area Burned by Wildfires",
    subtitle = "Moderate-Sized Wildfires"
  )
```

```{r}
#| label: fire-size-summary-stats
#| echo: false
#| warning: false

wildfire_clean |>
  summarise(
    Count = n(),
    Min = min(fire_size, na.rm = TRUE),
    Q1 = quantile(fire_size, 0.25, na.rm = TRUE),
    Median = median(fire_size, na.rm = TRUE),
    Mean = mean(fire_size, na.rm = TRUE),
    Q3 = quantile(fire_size, 0.75, na.rm = TRUE),
    Max = max(fire_size, na.rm = TRUE),
    SD = sd(fire_size, na.rm = TRUE)
  ) |>
  kable(digits = 2)
```

Next, we visualized the distribution of the quantitative variables of interest in our dataset (temperature (°C), relative humidity (%), and wind speed from 30 days prior to fire discovery (m/s), and remoteness), along with summary statistics to better understand their scale and variability. We first examined the distribution of temperature a month before discovery (top left panel), which we observed to be approximately normal and unimodal. (This is consistent with what we would generally expect, since temperature tends to change gradually across different areas rather than clustering at specific values.) The median temperature for wildfire observations in our dataset is 12.97°C and the mean is 13.58°C, with most observations between 6.53°C and 21.36°C.

We then examined the distributions of wind speed thirty days before discovery and remoteness (top right and bottom left panels, respectively). Wind speed appears to be very slightly right-skewed and unimodal, while remoteness appears more strongly right-skewed and unimodal. This indicates that most fires occurred relatively close to populated areas (lower remoteness) and that most wind speeds were low to moderate. The median remoteness for observations in our dataset is 0.21 and the mean is 0.25, with most observations between 0.15 and 0.35. The median wind speed for observations in our dataset is 2.89 m/s and the mean is 2.87 m/s, with most observations between 2.06 m/s and 3.76 m/s.

Lastly, we looked at the distribution of relative humidity thirty days before discovery (bottom right panel), which appears to be left-skewed and unimodal. This tells us that lower humidity conditions were more common among wildfires in our data. The median relative humidity for observations in our dataset is 63.53% and the mean is 55.20%, with most observations between 48.80% and 69.97%. However, we noticed that a large number of observations in our data recorded a relative humidity of exactly 0%. Given that 0% relative humidity is unlikely under normal atmospheric conditions (since even very dry air typically contains some moisture), we decided to exclude these observations from our analysis.

```{r}
#| label: quantitative-univariate-eda
#| echo: false
#| warning: false
#| fig-width: 8
#| fig-height: 5


p1 <- ggplot(wildfire_clean, aes(x = Temp_pre_30)) +
  geom_histogram(fill = "cadetblue4", color = "white", alpha = 0.8) +
  labs(
    title = "Temperature",
    subtitle = "30 days prior to fire discovery",
    x = "Temperature (°C)",
    y = "Frequency"
  ) +
  theme_minimal()

p2 <- ggplot(wildfire_clean, aes(x = Hum_pre_30)) +
  geom_histogram(fill = "cadetblue4", color = "white", alpha = 0.8) +
  labs(
    title = "Relative Humidity",
    subtitle = "30 days prior to fire discovery",
    x = "Relative Humidity (%)",
    y = "Frequency"
  ) +
  theme_minimal()

p3 <- ggplot(wildfire_clean, aes(x = Wind_pre_30)) +
  geom_histogram(fill = "cadetblue4", color = "white", alpha = 0.8) +
  labs(
    title = "Wind Speed",
    subtitle = "30 days prior to fire discovery",
    x = "Wind Speed (m/s)",
    y = "Frequency"
  ) +
  theme_minimal()

p4 <- ggplot(wildfire_clean, aes(x = remoteness)) +
  geom_histogram(fill = "cadetblue4", color = "white", alpha = 0.8) +
  labs(
    title = "Remoteness",
    subtitle = "Scaled distance from nearest urban area",
    x = "Remoteness (non-dimensional distance)",
    y = "Frequency"
  ) +
  theme_minimal()

(p1 | p3) /
(p4 | p2) + 
  plot_annotation(
    title = "Distribution of Quantitative Environmental Variables"
  )
```

```{r}
#| label: quantitative-summary-stats
#| echo: false
#| warning: false

wildfire_clean |>
  summarise(
    Temperature_Min = min(Temp_pre_30, na.rm = TRUE),
    Temperature_Q1 = quantile(Temp_pre_30, 0.25, na.rm = TRUE),
    Temperature_Median = median(Temp_pre_30, na.rm = TRUE),
    Temperature_Mean = mean(Temp_pre_30, na.rm = TRUE),
    Temperature_Q3 = quantile(Temp_pre_30, 0.75, na.rm = TRUE),
    Temperature_Max = max(Temp_pre_30, na.rm = TRUE),
    Temperature_SD = sd(Temp_pre_30, na.rm = TRUE),

    Humidity_Min = min(Hum_pre_30, na.rm = TRUE),
    Humidity_Q1 = quantile(Hum_pre_30, 0.25, na.rm = TRUE),
    Humidity_Median = median(Hum_pre_30, na.rm = TRUE),
    Humidity_Mean = mean(Hum_pre_30, na.rm = TRUE),
    Humidity_Q3 = quantile(Hum_pre_30, 0.75, na.rm = TRUE),
    Humidity_Max = max(Hum_pre_30, na.rm = TRUE),
    Humidity_SD = sd(Hum_pre_30, na.rm = TRUE),

    Wind_Min = min(Wind_pre_30, na.rm = TRUE),
    Wind_Q1 = quantile(Wind_pre_30, 0.25, na.rm = TRUE),
    Wind_Median = median(Wind_pre_30, na.rm = TRUE),
    Wind_Mean = mean(Wind_pre_30, na.rm = TRUE),
    Wind_Q3 = quantile(Wind_pre_30, 0.75, na.rm = TRUE),
    Wind_Max = max(Wind_pre_30, na.rm = TRUE),
    Wind_SD = sd(Wind_pre_30, na.rm = TRUE),

    Remoteness_Min = min(remoteness, na.rm = TRUE),
    Remoteness_Q1 = quantile(remoteness, 0.25, na.rm = TRUE),
    Remoteness_Median = median(remoteness, na.rm = TRUE),
    Remoteness_Mean = mean(remoteness, na.rm = TRUE),
    Remoteness_Q3 = quantile(remoteness, 0.75, na.rm = TRUE),
    Remoteness_Max = max(remoteness, na.rm = TRUE),
    Remoteness_SD = sd(remoteness, na.rm = TRUE)
  ) |>
  pivot_longer(everything(),
               names_to = c("Variable", "Statistic"),
               names_sep = "_") |>
  pivot_wider(names_from = Statistic, values_from = value) |>
  kable(digits = 2)
```

In addition to examining the distributions of quantitative predictors, we also visualized the distribution of categorical variables of interest in our dataset (i.e., wildfire cause category, vegetation group, region, and precipitation 30 days prior to wildfire discovery). Starting with precipitation 30 days before discovery, we observed that the majority of wildfire observations (5492 observations or 51.5%) corresponded to fires with no precipitation during that period, while the remaining observations (5179 observations or 48.5%) corresponded to fires where precipitation occurred.

```{r}
#| label: categorical-dist
#| echo: false
#| warning: false
#| fig-width: 8
#| fig-height: 5

wildfire_clean <- wildfire_clean |>
  mutate(
    Precipitation = factor(
      if_else(Prec_pre_30 == 1, "Precipitation", "No Precipitation"),
      levels = c("No Precipitation", "Precipitation")
    )
  )

base_theme <- theme_minimal() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))

p1 <- ggplot(wildfire_clean, aes(x = cause_category)) +
  geom_bar(fill = "cadetblue4", color = "white", alpha = 0.8) +
  labs(title = "Wildfire Cause Category", x = NULL, y = "Count") +
  base_theme

p2 <- ggplot(wildfire_clean, aes(x = Vegetation_group)) +
  geom_bar(fill = "cadetblue4", color = "white", alpha = 0.8) +
  labs(title = "Vegetation Group", x = NULL, y = "Count") +
  base_theme

p3 <- ggplot(wildfire_clean, aes(x = region)) +
  geom_bar(fill = "cadetblue4", color = "white", alpha = 0.8) +
  labs(title = "Region", x = NULL, y = "Count") +
  base_theme

p4 <- ggplot(wildfire_clean, aes(x = Precipitation)) +
  geom_bar(fill = "cadetblue4", color = "white", alpha = 0.8) +
  labs(title = "Precipitation", x = NULL, y = "Count") +
  base_theme

# Combine with normal patchwork
combined_plot <- (p1 | p2) /
                 (p3 | p4) +
  plot_annotation(
    title = "Distribution of Categorical Environmental Variables"
  )

combined_plot

categorical_vars <- c("cause_category", "Vegetation_group", "region", "Precipitation")
```

Looking more closely at vegetation group, we can see that most fires occurred in forested areas (5181 observations or 48.6%), followed by shrubland (2711 observations or 25.4%) and tundra or barren areas (2590 observations or 24.3%), with relatively few fires in grassland environments (189 observations or 1.77%). Examining wildfire cause categories, we found that a large portion of fires were attributed to human-related causes rather than natural causes. Debris burning accounted for the highest proportion (2821 observations or 26.4%), followed by arson (2399 observations or 22.5%) and other or unknown causes (2228 observations or 20.9%). Natural causes made up a smaller proportion (1535 observations or 14.4%), followed by recreational causes (853 observations or 8.0%) and infrastructure-related causes (835 observations or 7.82%).

Finally, we examined the regional distribution of fires. Most fires in our dataset occurred in the South (6090 observations or 57.1%), followed by the West (2801 observations or 26.2%), Midwest (1228 observations or 11.5%), and Northeast (550 observations or 5.15%). Only two fires (2 observations or less than 0.01%) were categorized as occurring in the "Other" region classification.

#### Bivariate EDA

As the next step in our analysis, we examined the relationship between each of our quantitative predictors and fire size to better understand their associations. As we can see in the scatter plot of burned area versus temperature (top left panel), the relationship between these two variables appears to be very weak and slightly positive (i.e., suggesting that larger fires may be slightly more likely at higher temperatures). The relationship also appears to be nonlinear, since most fires in our dataset seem to be pretty small regardless of temperature, and the largest fires (greater than 60 acres in size) most commonly occur between 5°C and 20°C. This tells us that while moderate temperatures may allow for larger fires, temperature alone does not strongly control fire size.

Similarly, the relationship between relative humidity and burned area (top right panel) appears to be very weak and highly nonlinear (with fires of all sizes occurring across almost all humidity levels and the largest fires tending to occur at mid-range humidity values at approximately 25% to 75%), but slightly negative (i.e., suggesting that burned area slightly decreases as humidity increases). As with temperature, the wide vertical spread of data points around the line of best fit tells us that relative humidity may not be a strong predictor of burned area on its own.

Additionally, the relationship between wind speed and burned area (bottom left panel) appears to be slightly positive (i.e., indicating a slight tendency for larger fires to occur at higher wind speeds), very weak, and highly nonlinear. As we can see in the plot, most data points in the plot are concentrated at lower wind speeds, and most larger fires (fires greater than 40 acres in size) occur below 5 m/s, which indicates that higher wind speeds are not consistently associated with larger burned areas.

Lastly, looking at the scatter plot of remoteness versus burned area (bottom right panel), we see a weak, slightly positive relationship between these two variables (i.e., suggesting that fires originating further away from cities may end up burning more acres of land, on average). This relationship also appears to be highly nonlinear, since the largest fires occur at moderate remoteness values between 0.25 and 0.50, and relatively few large fires at very high remoteness values greater than 0.75 (which tells us that burned area does not consistently increase or decrease across the range of remoteness values).

In general, there is a wide vertical spread (i.e., high variability) in the data points around the lines of best fit for all predictors, which suggests that the quantitative predictors in our dataset may have relatively limited predictive power for burned area when considered individually. That being said, this is somewhat expected given that wildfire size can be influenced by many factors beyond the limited set of quantitative predictors available in our dataset.

```{r}
#| label: fire-size-bivariate
#| echo: false
#| warning: false
#| fig-width: 8
#| fig-height: 5

sp1 <- ggplot(wildfire_clean, aes(x = Temp_pre_30, y = fire_size)) +
  geom_point(alpha = 0.3, color = "cadetblue4") +
  geom_smooth(method = "lm", se = FALSE, color = "gray40") +
  labs(
    title = "Temperature vs. Fire Size",
    subtitle = "30 days prior to fire discovery",
    x = "Temperature (°C)",
    y = "Burned Area (acres)"
  ) +
  theme_minimal()

sp2 <- ggplot(wildfire_clean, aes(x = Hum_pre_30, y = fire_size)) +
  geom_point(alpha = 0.2, color = "cadetblue4") +
  geom_smooth(method = "lm", se = FALSE, color = "gray40") +
  labs(
    title = "Relative Humidity vs. Fire Size",
    subtitle = "30 days prior to fire discovery",
    x = "Relative Humidity (%)",
    y = "Burned Area (acres)"
  ) +
  theme_minimal()

sp3 <- ggplot(wildfire_clean, aes(x = Wind_pre_30, y = fire_size)) +
  geom_point(alpha = 0.2, color = "cadetblue4") +
  geom_smooth(method = "lm", se = FALSE, color = "gray40") +
  labs(
    title = "Wind Speed vs. Fire Size",
    subtitle = "30 days prior to fire discovery",
    x = "Wind Speed (m/s)",
    y = "Burned Area (acres)"
  ) +
  theme_minimal()

sp4 <- ggplot(wildfire_clean, aes(x = remoteness, y = fire_size)) +
  geom_point(alpha = 0.2, color = "cadetblue4") +
  geom_smooth(method = "lm", se = FALSE, color = "gray40") +
  labs(
    title = "Remoteness vs. Fire Size",
    subtitle = "Scaled distance from nearest urban area",
    x = "Remoteness (non-dimensional distance)",
    y = "Burned Area (acres)"
  ) +
  theme_minimal()

(sp1 | sp2) /
(sp3 | sp4) +
  plot_annotation(
    title = "Relationship Between Environmental Factors and Burned Area",
    subtitle = "Quantitative Variables", 
    theme = theme(plot.title = element_text(hjust = 0))
  )

```

As part of our bivariate EDA, we also analyzed the relationship between each of our categorical variables of interest and burned area to better understand differences in fire size across groups. We can see from the visualization (top left panel) that the distribution of acres burned is relatively similar for all wildfire cause categories, with medians between 4.00 and 6.00 acres and means between 9.02 and 13.74 acres, and outliers beyond the 30-acre mark across all cause types. This indicates that cause category on its own does not explain much variability in fire size. We observed a similar pattern in terms of the distributions between observations corresponding to no precipitation 30 days before discovery and observations corresponding to precipitation (top right panel). The distributions of fire size appear to be very similar, with medians of 5.00 acres in both groups and means of 12.32 acres for no precipitation and 11.38 acres for precipitation, although there is slightly more spread in the middle 50% of fires with no precipitation compared to fires with precipitation.

We observed more apparent differences in the distribution of acres burned across different regions and vegetation groups (bottom left and bottom right panels, respectively). In particular, the Northeast had a lower median (3.00 acres) and mean (6.04 acres) compared to other regions, with much less variability in the middle 50% of fires and most outliers limited to about the 40-acre mark. In contrast, distributions for the West, South, and Midwest were more similar, with medians between 5.00 and 6.00 acres, means between 12.00 and 13.00 acres, and a large number of outliers beyond the 30-acre mark. For vegetation type, the distribution of fire size was fairly similar across categories, although grasslands had a slightly lower median (4.00 acres) and mean (8.43 acres) compared to other vegetation groups. That being said, the middle 50% of fire sizes and the overall range of outliers were generally similar across vegetation types, with grasslands showing somewhat fewer extreme outliers. Overall, region and vegetation group seem to explain more of the variability in fire size on their own compared to cause category or precipitation, and could potentially be useful predictors in modeling fire size.

```{r}
#| label: categorical-bivariate-dist
#| echo: false
#| warning: false
#| fig-width: 8
#| fig-height: 5

library(dplyr)
library(tidyr)
library(ggplot2)

wildfire_clean_long <- wildfire_clean |>
  pivot_longer(
    cols = c(Vegetation_group, cause_category, region, Precipitation),  
    names_to = "Group_Type",
    values_to = "Group"
  ) |>
  mutate(
    Group_Type = dplyr::case_match(
      Group_Type,
      "Vegetation_group" ~ "Vegetation Type",
      "cause_category"   ~ "Cause Category",
      "region"           ~ "Region",
      "Precipitation"    ~ "Precipitation",
      .default = Group_Type
    )
  )

ggplot(data = wildfire_clean_long, 
       aes(x = Group, y = fire_size, color = Group)) +
  geom_boxplot(fill = NA, outlier.alpha = 0.6) +
  coord_flip() +
  facet_wrap(~ Group_Type, scales = "free_y") +
  scale_color_manual(
    values = colorRampPalette(c("#8FBC8F", "cadetblue4"))(
      length(unique(wildfire_clean_long$Group))
    )
  ) +
  labs(
    title = "Relationship Between Environmental Factors and Burned Area",
    subtitle = "Categorical Variables",
    x = NULL,
    y = "Burned Area (acres)",
    color = NULL
  ) +
  theme_minimal() +
  theme(
    plot.title = element_text(hjust = 0, size = 12),
    plot.subtitle = element_text(hjust = 0, size = 10),
    legend.position = "none"
  )
```

#### Potential Interaction Effects

Since many of our variables of interest relate to environmental conditions and geographic location, there are many possible interaction effects among our predictors that could help explain variability in acres burned. As part of our analysis, we looked at two potential interaction effects that we thought might be the most meaningful. First, we analyzed whether there was a potential interaction between temperature and region in explaining variability in burned area, since temperature may influence wildfire size differently across regions (e.g., regions like the Northeast generally experience cooler temperatures, which could lead to different fire behavior compared to hotter, drier regions like the West). As we can see in the visualization below, there does appear to be an interaction effect, since the magnitude and direction of the relationship between temperature and burned area vary across regions. (Specifically, the relationship between temperature and burned area appears to be slightly positive for regions like the Midwest and West, while the trend appears slightly negative for the South and Northeast.) A possible explanation for this could be that, in cooler regions, increases in temperature may support fire spread, while in already hot and humid regions, temperature may not have the same effect due to other limiting factors like vegetation or moisture levels. This interaction would be interesting to look into more formally when modeling fire size to determine whether it significantly improves model fit.

```{r}
#| label: fire-temp-int
#| echo: false
#| warning: false
#| fig-width: 8
#| fig-height: 5

ggplot(wildfire_clean, aes(x = Temp_pre_30, y = fire_size)) +
  geom_point(alpha = 0.3, color = "cadetblue4") +
  geom_smooth(method = "lm", se = FALSE, color = "gray40") +
  facet_wrap(~ region) +
  labs(
    title = "Relationship Between Temperature and Burned Area", 
    subtitle = "Grouped by Region", 
    x = "Temperature (°C)",
    y = "Burned Area (acres)"
  ) +
  theme_minimal() +
  theme(
    plot.title = element_text(size = 11),    
    plot.subtitle = element_text(size = 9),
    axis.title.x = element_text(size = 9),
    axis.title.y = element_text(size = 9)
  )
```

We were also interested in a potential interaction between vegetation type and precipitation, since vegetation and fuel moisture could influence burned area together. However, based on the visualization below, the distributions of burned area appear relatively similar between precipitation and no precipitation conditions for each vegetation group. In forest, the median burned area is 5.0 acres for both no precipitation (mean of 11.48 acres) and precipitation (mean of 11.14 acres), while in grassland, the median is 3.5 acres for no precipitation (mean 12.26 acres) and 3.0 acres for precipitation (mean of 11.54 acres). Additionally, in shrubland, the median is 6.0 acres for no precipitation (mean of 13.52 acres) and 5.0 acres for precipitation (mean of11.31 acres), while in tundra/barren, the median is 5.0 acres for both no precipitation (mean of 12.81 acres) and precipitation (mean of 11.86 acres). Even though there does not seem to be a very strong interaction effect, and we will further examine this during modeling.

```{r}
#| label: veg-prec-int
#| echo: false
#| warning: false
#| fig-width: 8
#| fig-height: 5

ggplot(wildfire_clean, aes(x = Vegetation_group, y = fire_size, color = Precipitation)) +
  geom_boxplot(fill = NA, outlier.alpha = 0.6) +
  theme_minimal() +
  labs(
    title = "Relationship Between Vegetation Type and Precipitation",
    subtitle = "Grouped by Burned Area",
    x = "Vegetation Group",
    y = "Burned Area (acres)",
    color = "Precipitation"
  ) +
  theme(
    plot.title = element_text(size = 11, hjust = 0),
    plot.subtitle = element_text(size = 9, hjust = 0),
    axis.title.x = element_text(size = 9),
    axis.title.y = element_text(size = 9)
  ) +
  scale_color_manual(values = c("No Precipitation" = "cadetblue4", "Precipitation" = "#8FBC8F")) +
  coord_flip()
```

## Methodology

Since the main goal of our analysis was to understand how different wildfire-related factors are associated with burned area (a continuous numerical response variable) and how these factors could be used to predict burned area, we decided to use multiple linear regression as the primary modeling approach for this project. Specifically, since our analysis was guided by two different research questions, we fit two different models as part of our analysis: one model using only variables that would be available before or at the time of fire discovery to inform early response efforts (i.e., a predictive model), and another model using all variables of interest, including those that would only be available after a fire was contained (i.e., an explanatory model) to explain variability in burned area that would not be captured by predictive variables alone.

To guide variable selection for the predictive model, we fit a full model including all of the explanatory variables we were interested in. This approach made sense because our dataset contained a limited number of predictors corresponding to information that would already be available prior to fire discovery, so it was practical to include all relevant variables rather than selecting a smaller subset. For the explanatory model, we used a forward selection-based approach based on adjusted $R^2$ (since adjusted $R^2$ accounts for model fit while penalizing the inclusion of unnecessary predictors) to build a model that added predictors of interest only when they improved adjusted $R^2$. The final explanatory model included many of the predictors from the predictive model, along with additional variables that could help explain variability in fire size.

### Predictive Modeling

To begin our predictive modeling process, we first fit a model predicting fire size from region, temperature, wind speed, precipitation, and relative humidity (all measured thirty days before fire discovery), along with remoteness, vegetation group, and interaction terms between region and temperature and between vegetation group and precipitation. After fitting this model, we conducted model diagnostics to evaluate whether key assumptions of linear regression were reasonably satisfied (i.e., linearity, normality, constant variance, and independence). Based on our analysis, we found that the linearity, normality, and independence conditions were reasonably satisfied, but the constant variance condition was not satisfied. As a result, we applied a variance-stabilizing (i.e., logarithmic) transformation to the response variable to address non-constant variance.

Additionally, when examining the distribution of residuals versus fitted values for this initial model, we observed a clustering of observations into two groups (one group with fitted values less than or equal to 5, and another with fitted values between 5 and 20). Through further investigation, we realized that this clustering was in part explained by differences in region. As we saw in our exploratory data analysis, fires in the Northeast generally corresponded to smaller burned areas compared to fires in other regions, which likely contributed to the small separation observed in the residuals versus fitted values plot. To address this, we explored whether fitting two separate models (one for fires occurring in the Northeast and one for fires occurring in other regions) would improve model fit, but we ultimately decided to proceed with a single model including all regions because the improvement in fit was very limited (and for the sake of consistency in model interpretation).

We also checked for influential points based on Cook’s Distance ($D_i > 0.5$), and found no such observations in our dataset that could substantially affect regression coefficient estimates. Lastly, in this model, we found evidence of collinearity between region and temperature (with the main effects and interaction terms for these variables having VIFs greater than 10). To address this, instead of including an explicit interaction term, we centered temperature within each region and used this centered variable in the model to account for within-region temperature variation while reducing collinearity. To note, we did not find concerning evidence of collinearity between vegetation group and precipitation, so the interaction between these variables was retained in the model.

```{r}
#| label: linear-model

exp_fire_int_fit <- lm(
  log(fire_size) ~ region + Temp_pre_30 + remoteness * Vegetation_group +
    Wind_pre_30 + Prec_pre_30 + Hum_pre_30,
  data = wildfire_clean
)

glance(exp_fire_int_fit)
vif(exp_fire_int_fit)
```

### Explanatory Modeling

As part of our explanatory modeling process, we retained all of the vairables in oru rpeicigve modeling (rpocodess.idk), but added putout time and cause cagtegory (find mroea aoptiw woridng) to . We consduerd both of thesevarbales at this step since (explain ) (The casue of a widlfire is likely only to be known muchbafter the fire and coanot be ued to rpedcigt, and putout time.....) These factros provide

```{r}

exp_fire_int_fit_exp <- lm(
  log(fire_size) ~ region + Temp_pre_30_region_centered + remoteness + Vegetation_group +
    Wind_pre_30 + Vegetation_group * Prec_pre_30 + Hum_pre_30 + putout_time_num +
    cause_category, 
  data = wildfire_clean
)

glance(exp_fire_int_fit_exp)
vif(exp_fire_int_fit_exp)
```

## Results

We fit four linear regression models to predict `log(fire_size)` using combinations of environmental and fire-related predictors. Two models included precipitation as a continuous predictor (`log(Prec_pre_15 + 0.001)`), and two models used a binary indicator variable representing the presence of precipitation. Each modeling approach included a main-effects model and an interaction model with `Vegetation`.

The adjusted $R^2$ values were low across all models. The main-effects model with continuous precipitation (`fire_main_fit`) had an adjusted $R^2$ of 0.037, and the interaction model (`fire_int_fit`) had an adjusted $R^2$ of 0.041. The models using the binary precipitation indicator produced similar results: 0.037 for the main-effects model (`fire_main_bin`) and 0.039 for the interaction model (`fire_int_bin`).

We evaluated prediction error using root mean squared error (RMSE) on the log scale. The RMSE was 1.059 for both `fire_main_fit` and `fire_main_bin`, and slightly lower for the interaction models: 1.057 for `fire_int_fit` and 1.058 for `fire_int_bin`. These values indicate that the average prediction error on the log-transformed scale was around 1.06. On the original scale, this corresponds to a multiplicative prediction error of approximately 2.88 (i.e., $\exp(1.06) \approx 2.88$).

Overall, there were minimal differences in adjusted $R^2$ and RMSE between the models using continuous precipitation and those using a binary indicator. The addition of interaction terms with `Vegetation` slightly increased model complexity without meaningfully improving predictive performance.

## Discussion and Conclusions

## Appendix

```{r}
#| label: residuals-fitted-vals-plot

exp_fire_int_fit_aug <- augment(exp_fire_int_fit)

ggplot(exp_fire_int_fit_aug, aes(x = .fitted, y = .std.resid, color = .cooksd)) +
  geom_point() +
  geom_hline(yintercept = 0, linetype = "dashed", color = "red") +
  labs(
    title = "Standardized Residuals vs. Fitted Values",
    x = "Fitted Values",
    y = "Standardized Residuals",
    color = "Cook's Distance"
  ) +
  theme_minimal()

high_cooks_points <- exp_fire_int_fit_aug |>
  filter(.cooksd > 1) |>
  select(.fitted, .std.resid, .cooksd)

high_cooks_points
```

spatial distribution of residuals - independence

```{r}
#| label: spatial-distribution-residuals

exp_fire_int_fit_aug <- exp_fire_int_fit_aug |>
  mutate(
    latitude = wildfire_clean$latitude,
    longitude = wildfire_clean$longitude
  )

us_map <- map_data("state")

ggplot() +
  geom_polygon(
    data = us_map,
    aes(x = long, y = lat, group = group),
    fill = "white", color = "gray60"
  ) +
  geom_point(
    data = exp_fire_int_fit_aug |> filter(longitude > -130, longitude < -65, latitude > 24, latitude < 50),
    aes(x = longitude, y = latitude, color = .resid),
    size = 1.5, alpha = 0.7
  ) +
  scale_color_distiller(
    palette = "RdBu", direction = 1,
    name = "Residual", limits = c(min(exp_fire_int_fit_aug$.resid), max(exp_fire_int_fit_aug$.resid))
  ) +
  coord_fixed(1.3) +
  labs(
    title = "Spatial Distribution of Residuals",
    x = "Longitude",
    y = "Latitude"
  ) +
  theme_minimal()
```

```{r}
exp_fire_int_fit_aug <- exp_fire_int_fit_aug |>
  mutate(disc_pre_year = wildfire_clean$disc_pre_year)

ggplot(exp_fire_int_fit_aug, aes(x = disc_pre_year, y = .resid)) +
  geom_point(alpha = 0.6) +
  geom_smooth(method = "loess", se = FALSE, color = "gray40") +
  labs(
    title = "Residuals vs. Year of Discovery",
    x = "Discovery Year",
    y = "Residual"
  ) +
  theme_minimal()
```

```{r}
#| fig-width: 8
#| fig-height: 6

p1 <- ggplot(exp_fire_int_fit_aug, aes(x = remoteness, y = .resid)) +
  geom_point(alpha = 0.2) +
  geom_hline(yintercept = 0, linetype = "dashed", color = "red") +
  labs(x = "Remoteness", y = "Residuals", title = "Residuals vs. Remoteness") +
  theme_minimal()

p2 <- ggplot(exp_fire_int_fit_aug, aes(x = Wind_pre_30, y = .resid)) +
  geom_point(alpha = 0.2) +
  geom_hline(yintercept = 0, linetype = "dashed", color = "red") +
  labs(x = "Wind (Pre 30 days)", y = "Residuals", title = "Residuals vs. Wind") +
  theme_minimal()

p3 <- ggplot(exp_fire_int_fit_aug, aes(x = Temp_pre_30, y = .resid)) +
  geom_point(alpha = 0.2) +
  geom_hline(yintercept = 0, linetype = "dashed", color = "red") +
  labs(x = "Temperature (Pre 30 days)", y = "Residuals", title = "Residuals vs. Temperature") +
  theme_minimal()

p4 <- ggplot(exp_fire_int_fit_aug, aes(x = Hum_pre_30, y = .resid)) +
  geom_point(alpha = 0.2) +
  geom_hline(yintercept = 0, linetype = "dashed", color = "red") +
  labs(x = "Humidity (Pre 30 days)", y = "Residuals", title = "Residuals vs. Humidity") +
  theme_minimal()

(p1 + p2) / (p3 + p4) +
  plot_annotation(
    title = "Relationship Between Residuals and Predictors",
    subtitle = "", 
    theme = theme(
      plot.title = element_text(size = 14, hjust = 0, family = "sans")
    )
  )
```

```{r}
ggplot(exp_fire_int_fit_aug, aes(x = remoteness, y = .resid)) +
  geom_point(alpha = 0.2) +
  geom_hline(yintercept = 0, linetype = "dashed", color = "red") +
  labs(x = "Remoteness", y = "Residuals", title = "Residuals vs. Remoteness") +
  theme_minimal()

fire_log_fit <- glm(mid50_hi ~ region + Temp_pre_30_region_centered + remoteness + Vegetation_group +
    Wind_pre_30 + Vegetation_group * Prec_pre_30 + Hum_pre_30 + putout_time_num +
    cause_category, data = wildfire_clean, family = "binomial")

tidy(fire_log_fit, conf.int = TRUE) |>
  kable(digits = 3)

```

```{r}


fire_log_aug <- augment(fire_log_fit)

roc_curve_data <- fire_log_aug |>
  roc_curve(mid50_hi, .fitted, event_level = "second")

autoplot(roc_curve_data)
```

```{r}

fire_log_aug |>
  roc_auc(mid50_hi, .fitted, event_level = "second")
```
